{"path":"Papers/Biomedical Engineering papers/System Analyze of the Windkessel Models.pdf","text":"SYSTEM ANALYZE OF THE WINDKESSEL MODELS Jan Hauser1, Jakub Parak 1, Miroslav Lozek 1, Jan Havlik 1 1Deparment of Circuit Theory, Faculty of Electrical Engineering, CTU in Prague Abstract This paper describes system analyze of the Windkessel models. The equations, space state and transfer functions of 2, 3 and 4 elements Windkessel models are described. The Simulink environment model schemas are presented as well. The Bode frequency and step response analyses are presented for all three models as well. Moreover the simulation of the special input signal which represents blood flow is described. The output signals are compared between each other and with existing published Winkessel models simulation. The results of comparison are discussed. Keywords Windkessel effect, Windkessel models, system analyze, frequency and step response Introduction The first Windkessel model was introduced by Otto Frank, the German physiologist. It was the hydraulic circuit consisting of a water pump connected to a chamber. It serves to simulating the real cardiac circle and to researching some important parameters of this circle, e.g. the interaction between the stroke volume and the compliance of the aorta and large elastic arteries [1]. The electrical circuits behave very similarly as the real model. Models could be simulated using RC and RL circuits which current source. The output voltage characterizes the blood pressure in vessels. The Windkessel models could be used for measure brachial artery blood flow or estimation of cardiac output and stroke volume [2, 3]. This article presents basic equations simulations and system analyzes which can be used for next research purposes like to compare simulations with mechanical model of cardiovascular system [4]. This analyze is also important for next estimation of model parameters from cardiac output and invasive blood pressure measurement. For analyze were used parameters which are described in the article [1]. The comparison and verification with existing published Windkessel model which was simulated in Matlab environment is described. The differences between obtained and existing results in Matlab simulations are discussed in conclusion. Description of the models In the Figure 1 are shown electrical circuits of all three types of Windkessel models. The models are created by a combination of RC and RL elements Fig. 1: Three types of Windkessel models [1]. There are two functions variable in time. The first one i(t) is the input function and shows blood flow and the second one u(t), the output function, represents the blood pressure. These two functions are appeared in all three Windkessel models. Simulation parameters The parameter R describes the total peripheral resistance. The compliance of veins is represented by C parameter. Both of parameter are used in all Windkessel models. The next r parameter simulates aortic or pulmonary value. It is a resistance to blood flow. This parameter is used only in 3 and 4 element Windkessel model. The last parameter L represents the inertia of blood flow. This parameter is implemented in 4 element Windkessel model [5]. Every change of R, L, C or r parameter produces a change of simulation results. The values that have been used in all the simulations are R = 0.79, C = 1.22, r = 0.056, L=0.0051. They have been obtained from the article [1]. 2 elements Windkessel model The first one is very simple 2 elements Windkessel model (2WM). The differential equation (1) describes the model. dt tdu C R tu ti )()( )( ⋅+= (1) From this differential equation, we can get the following description of the space state matrices and transfer function of 2WM. [ ] [ ]0,1, 1 , 1 ==    =   −= DC C B RC A (2) 1 )( + = sRC R sH (3) In the Figure 2 is shown Simulink schema of 2WM. Fig. 2: 2WM Simulink model schema.. Using the transfer function the Step and Bode frequency response can be simply obtained in Matlab environment. The frequency response is displayed in the Figure 3 and the Step response is show in the Figure 4. Based on these plots can be argued that this model behaves like low pass filter. Fig. 3: Bode frequency response. Fig. 4: 2WM Step response. 3 elements Windkessel model The next model is 3 elements Windkessel modes (3WM). This model has better simulates blood pressure curve, because the parameter r is added. The 3WM is described differential equations (4) and (5) which are described here. dt tdu C Rtu ti CC )()( )( ⋅+= (4) )()()( turtitu C+⋅= (5) The space state matrices (3) and system transfer function (4) of 3WM model are written below. This model in contrast with 2WM has one pole and one zero. [ ] [ ]rDC C B RC A ==    =    −= ,1, 1 , 1 (7) 1 )( + ++ = sRC RrsRCr sH (8) In the Figure 3 is shown Simulink schema of 3WM. Moreover except of the feedback this model uses feedforward. Fig 3: 3WM Simulink model schema. The step response and Bode frequency response are displayed in the Figures 4 and 5. These simulations demonstrate that 3WM is low pass filter like a 2WM. Fig. 4: 3WM Step response. Fig. 5: 3WM Bode frequency response. 4 elements Windkessel model The last 4 elements Windkessel model (4WM) is the most realistic approximation of the real biologic system. This model is expanded on r and L parameter. The differential equations of 4WM model are below. )( 1 )( 1)( ti C tu CRdt tdu C C ⋅+⋅ ⋅ −= (9) dttdi r L titi L L )( )()( ⋅+= (10) ( ))()()()( titirtutu LL −⋅+= (11) The space state matrices (12) and transfer function (13) description of this models is a bit more difficult than description of 2WM and 3WM models. rsRCrsLRCLs RrsLrsLRRCLrs sH +++ +++ = 2 2 )( (12)         =         − − = L r CB L r RCA 1 , 0 0 1 [ ] [ ]rDrC =−= ,1 (13) The Simulink model schema is shown in the Figure 6. This schema has two feedbacks and one feedforwards. This model is 2nd order system. In the Figure 7 and 8 are plotted step and Bode frequency response of 4WM model. Fig. 6: 4WM Simulink mode schema. Fig. 7: 4WM Step response. Fig. 8: 4WM Bode frequency response. Blood flow input signal The described input signal was used for simulation of the blood flow. The signal was taken from [1]. This signal input function is described by the formula (14). In spite of very realistic input signal curve, the cardiac output per minute of this signal is incorrect. When the beat blood ejection is 500 ml per each beat, the total cardiac output is in 72 beats per minute 36 liters. The usually physiological cardiac output of healthy man is about 5 liters per minute. Whereas these values are not physiological, they were used for next simulations for existing model result comparison. In the Figure 9 is shown the input signal curve which is created according to the description in formula (10). Moreover the signal frequency spectrum is displayed in chart in the Figure 10. The signal contains only frequencies lower that approximately 10 Hz. This information is very important because all models behave like low pass filters. | |  ∈ ∈||    ⋅ ⋅ = TTt Tt T t I ti S S S ,,0 ,0,sin )( 2 0 π (14) Fig. 9: Simulation of input function i(t) (blood flow). Fig. 10: Spectrum of input function i(t) (blood flow). Comparison with existing model In the Figure 11 are depicted curves from simulation which are presented in publication [1]. These results look very unrealistic because of many non-linear shapes in blood pressure signal simulations. The result of our simulations with same parameters and models are different than results described in [1]. In the Figure 12 are displayed blood pressure output curves of all three models from our simulations. The reason of difference between two same simulations was not observed. It is possible that results presented in [1] could be obtained by methods that were not presented in the publication [1]. The most realistic blood pressure curves were obtained from 4WM simulation, because the 2WM and 3WM models are very simple to create dicrotic notch. The differences between output signal amplitude of models is subject of next research. Fig. 11: Published results of all three Windkessel models simulation [1]. Arterial pressure for three WM (a – measured pressure (solid line), b – 4WM (dashed line), c – 3WM (dot line), d – 2WM (dot-and-dash line)) Fig. 12: Simulation of all three Windkessel models. Conclusion The system analyze of Windkessel models was done. The 2, 3 and 4 element Windkessel models were created and simulated in Matlab Simulink environment. The differential equations, state space matrices and transfer function were described in the paper. The frequency response Bode plot and step responses were presented as well. In spite of using same R, L, C and r constant parameters for simulation as in existing published simulation, the different results were obtained. In addition the all output values were compared with each other. The calculated results will be compared with other kinds of cardiovascular system models. This analyze will be also used for better estimation of model parameters from cardiac output and invasive blood pressure measurement. Acknowledgement This work has been also supported by the research program No. MSM 6840770012 of the Czech Technical University in Prague (sponsored by the Ministry of Education, Youth and Sports of the Czech Republic). This work has been also supported by the grant No. SGS12/143/OHK3/2T/13 of the Czech Technical University in Prague. This work has been also supported by the grant No. F3a 2177/2012 presented by University Development Foundation. References [1] M. Hlaváč, J. Holčík, „WINDKESSEL MODEL ANALYSIS IN MATLAB“, in Proc 2004 Student Electrical Engineering, Information and Communication Technologies, Brno 2004. [Online]. Available: http://www.feec.vutbr.cz/EEICT/2004 /sbornik/03-Doktorske_projekty/01-Elektronika/09-lahvo.pdf [2] T. P. Arai, Kichang Lee, R. J. Cohen, R.J, “Cardiac output and stroke volume estimation using a hybrid of three Windkessel models,” in Proc Annual International Conference of the IEEE Engineering in Medicine and Biology Society, Argentina 2010, pp. 4971 – 4974. [3] Shing-Hong Liu, Jia-Jung Wang , “Using Windkessel Model to Measure Brachial Blood Flow,” in Proc 5th International Conference on Bioinformatics and Biomedical Engineering, China 2011, pp. 1 - 4. [4] M. Lozek, M. Horalkova, J. Havlik, “Mechanical Model of the Cardiovascular System: Determination of Cardiac Output by Dye Dilution”, Lékař a technika, 2012, vol. 2, pp 77 – 80. [5] Anna Lombardi, Linkoping University (2012, March). Biomedical modeling and simulation, Lecture 2. ODE and DAE. [Online]. Available: https://www.imt.liu.se/edu/courses /TBME08/pdf/TBME08_AL_lec2.pdf Jan Hauser Department of Circuit Theory Faculty of Electrical Engineering Czech Technical University in Prague Technicka 2, 166 27, Prague, Czech Republic E-mail: hauseja3@fel.cvut.cz","libVersion":"0.2.3","langs":""}