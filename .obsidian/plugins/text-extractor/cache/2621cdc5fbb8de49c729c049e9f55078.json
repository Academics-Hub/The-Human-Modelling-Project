{"path":"Papers/Biomedical Engineering papers/Cardiac Output and Stroke Volume Estimation using a hybrid of three windkessel models.pdf","text":"MIT Open Access Articles Cardiac output and stroke volume estimation using a hybrid of three models The MIT Faculty has made this article openly available. Please share how this access benefits you. Your story matters. Citation: Arai, T., Kichang Lee, and R.J. Cohen. “Cardiac Output and Stroke Volume Estimation Using a Hybrid of Three Windkessel Models.” Engineering in Medicine and Biology Society (EMBC), 2010 32nd Annual International Conference of the IEEE. Buenos Aires, Argentina, August 31 - September 4, 2010. 4971-4974. © 2011 IEEE. As Published: http://dx.doi.org/10.1109/iembs.2010.5627225 Publisher: Institute of Electrical and Electronics Engineers Persistent URL: http://hdl.handle.net/1721.1/64992 Version: Final published version: final published article, as it appeared in a journal, conference proceedings, or other formally published context Terms of Use: Article is made available in accordance with the publisher's policy and may be subject to US copyright law. Please refer to the publisher's site for terms of use. Abstract— Cardiac output (CO) and stroke volume (SV) are the key hemodynamic parameters to be monitored and assessed in ambulatory and critically ill patients. The purpose of this study was to introduce and validate a new algorithm to continuously estimate, within a proportionality constant, CO and SV by means of mathematical analysis of peripheral arterial blood pressure (ABP) waveforms. The algorithm combines three variants of the Windkessel model. Input parameters to the algorithm are the end-diastolic pressure, mean arterial pressures, inter-beat interval, and the time interval from end-diastolic to peak systolic pressure. The SV estimates from the three variants of the Windkessel model were weighted and integrated to provide beat-to-beat SV estimation. In order to validate the new algorithm, the estimated CO and SV were compared to those obtained through surgically implanted Transonic™ aortic flow probes placed around the aortic roots of six Yorkshire swine. Overall, estimation errors in CO and SV derived from radial ABP were 10.1% and 14.5% respectively, and 12.7% and 16.5% from femoral ABP. The new algorithm demonstrated statistically significant improvement in SV estimation compared with previous methods. I. INTRODUCTION TROKE volume (SV) and cardiac output (CO) are the key hemodynamic parameters to be monitored and assessed in ambulatory and critically ill patients. Currently, hemodynamic monitoring of patients in critical care settings depends heavily on the monitoring of arterial blood pressure (ABP). However, ABP is a late indicator of hemodynamic abnormality because physiologic feedback systems maintain ABP until the patient develops hemodynamic collapse and death [1]. CO and SV monitoring enables earlier prediction of hemodynamic collapse, but CO and SV are more difficult to measure and monitor. Since thermodilution [2], the gold standard of CO measurement, requires pulmonary artery catheterization which is associated with cardiovascular risks [3, 4] and has limited accuracy [5], pulse contour methods (PCMs) have been extensively studied [6-12] as a means of estimating CO from analysis of the continuous ABP signal. A conventional PCM approach to minimally invasive CO estimation is based Manuscript received April 22, 2010. Asterisk indicates corresponding author. T. Arai is with the Department of Aeronautics and Astronautics, Massachusetts Institute of Technology (MIT), Cambridge, MA 02139 USA. K. Lee is with Harvard-MIT Division of Health Sciences and Technology, MIT, Cambridge, MA 02139 USA. *R. J. Cohen is with the Harvard-MIT Division of Health Sciences and Technology, 77 Massachusetts Avenue, Cambridge, MA 02139 USA (617-253-0009; fax: 617-253-3019; e-mail: rjcohen@mit.edu). on the two- parameter Windkessel model that involves aortic compliance (Ca) and total peripheral resistance (TPR) (Figure 1). When the diastolic decay in blood pressure is governed by the Windkessel time constant (τ), CO and SV can be estimated from the measurement of mean arterial pressure (MAP), Ca, τ, and pulse pressure (PP). However, these methods are not applicable to peripheral ABP waveforms because peripheral ABP waveforms tend to distort as they propagate through the elastic tapered arterial network and, in particular, ABP waveforms in the peripheral arteries generally do not display exponential decay during the diastolic phase. Thus it is difficult to obtain the Windkessel time constant (τ) [10]. For these reasons, the PCM has not achieved sufficient accuracy or reliability to be adopted clinically [13]. In order to further minimize error and enable continuous estimation of CO and beat-to-beat SV, we have developed a novel CO and SV estimation algorithm based on end-diastolic blood pressure (end-DBP) values, beat-MAP (MAPi - MAP of a single beat), inter-beat interval (Ti), and the time interval from end-DBP to peak SBP (Ti S) in the peripheral ABP waveform. These variables are selected for estimation of CO and SV because they are known to be relatively insensitive to the distortion of the ABP waveform in the arterial tree [14]. The purpose of this study was to validate the algorithm we developed in in-vivo animal studies, and compare it with the other methods. II. METHODS A. Algorithm Figure 2 illustrates measured ABP and the theoretical Cardiac Output and Stroke Volume Estimation Using a Hybrid of Three Windkessel Models Tatsuya Arai, Member, IEEE, Kichang Lee, and Richard J. Cohen, Member, IEEE S BF Ca TPR ABP 25 26 27 0.5 1.0BF (ml/s) 25 26 27 Time (s) 110 90 70ABP (mmHg) CO MAP τ∝CO MAP τ∝ τ =TPR Caτ =TPR Ca Fig. 1. Two-parameter Windkessel model [3]. Current, resistance, capacitance, voltage, and mean voltage are represented by instantaneous blood flow (BF), total peripheral resistance (TPR), aortic compliance (Ca), arterial blood pressure (ABP), and mean arterial pressure (MAP), respectively. 32nd Annual International Conference of the IEEE EMBS Buenos Aires, Argentina, August 31 - September 4, 2010 978-1-4244-4124-2/10/$25.00 ©2010 IEEE 4971 Windkessel model ABP. Although Ca declines with age [15], Ca is nearly constant on the time scale of months over a wide pressure range [16, 17], thus Ca was assumed to be constant throughout this relative short experimental period. For each cardiac cycle, the two end-DBP values (Pi D, Pi+1 D) were obtained. Then, the theoretical Windkessel ABP waveform was generated using the following equations: ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ − −= i D iD i tt PtP τ )( exp)( for S i D i ttt << (1) () ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ − − ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ + ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ −= i S i ai S iD i tt C iSVT PtP ττ )( expexp)( for D i S i ttt 1+<< (2) where ti D and ti S are time stamps of the end of diastole (onset of systole) and the peak systolic point of the ith ABP waveform, respectively. Pi D is end-DBP immediately preceding the ith beat of measured ABP. Ti S and Ti are the periods from the end-DBP to the peak systolic point and inter-beat interval of the i th ABP waveform, respectively. SV(i) is the SV of the ith beat. Each impulse of ABP waveform is aligned to each systolic peak point of measured ABP. The Windkessel time constant (τ) was adjusted so that for each beat the MAP of the measured ABP equaled the MAP of the Windkessel ABP. Taking the average of ABP over the ith beat using the above equations (1 and 2), the MAP can be expressed by Ti, Pi D, Pi+1 D, SV(i), τι , and Ca as follows. () )()( 1 1 1 D i a D i i i t t i i i P C iSV P T dttP T MAP D i D i +−+== ∫ + τ (3) As shown in Figure 2, the ith-beat PP of the ideal Windkessel ABP from (2) can be calculated by subtracting the two ABP values at Ti S: () ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ −− ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ − = + i S iD i i S iiD i a T P TT P C iSV ττ exp )( exp1 (4) Substituting (4) into (3), }exp1()1 )( (exp{ 1 ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ −−+−⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ − = + i S iD i i S iiD i i i i T P TT P T MAP ττ τ (5) Equation (5) can be numerically solved for τι. In actual implementation, the median value of τ calculated using (5) over a 20-second moving window is used to exclude outliers, and regarded as the τ of the beat in the middle of the window. Continuous SV was calculated by shifting the 20-second moving window beat-by-beat. An interval of 20 seconds was empirically found by the authors to provide the smallest estimation errors over a wide range of physiological conditions. However, in fact it is not known when the impulse corresponding to peak aortic blood flow occurs. Since the blood flow peak occurs before peak SBP time, we introduced two Windkessel models to cover the extremes of possible impulse times: Model 1) Impulse at the SBP peak (shown in Fig. 2) () () ( ) S ii D i D ii a prop TTPPMAPf C iSV iSV ,,,, 11 +== (6a) Model 2) Impulse at the beginning of the ABP waveform () ()i D i D iiTpropprop TPPMAPfSViSV S i ,,, 1012 += == (6b) Here SVprop1 and SVprop2 are proportional to SV with a proportionality constant of 1/Ca. A third steady state model is introduced that assumes that Pi D =Pi+1 D: Model 3) Steady state assumption () ()i D iiPPpropprop TPMAPfSViSV D i D i ,, 1 23 == += (6c) Of the five measured parameters, there are three dimensionless variables (Ti S/ Ti, Pi D/ MAPi, and Pi+1 D/ MAPi) that characterize the ABP waveform. Thus combining the three models for estimating SVprop should span the space covered by the three dimensionless parameters. One hybrid model for estimating SV is given by : () () () () () 21 1 3 1 2 1 a prop prop a prop prop propai iSV iSV iSV iSV iSVCSV ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ ⋅ ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ ⋅= (7) Note that (7) is a hybrid model of SVprop1, SVprop2 and SVprop3, geometrically weighted using the exponents a1 and a2. For example, if a1=0 and a2=1, then SV=CaSV2 and (6b) is adopted. The coefficients allow non-discrete switching between the three models. By taking natural logarithm of (7), the equation becomes linear ( ) () ( )( ) ( )jiXajiXajiyjDjiy ,,,, 22111 +++= (8) where i is beat number, j is subject number, y=ln(SVi), D(j)=ln(Ca), y1=ln(SVprop1), X1= ln(SVprop2/ SVprop1), and X2=ln (SVprop3/ SVprop1). Linear regression and least mean square error analysis yield aortic compliances Ca(j), a1, and a2. It is possible to generalize the hybrid model by introducing terms involving X1 and X2 raised to higher powers: 65 70 75 80 85 90 95 100 677.6 677.8 678 678.2 i th beat Ti S Pi+1D SV(i) Ca SV(i) Ca PiD Measured Model 0.60 tiD ti S ti+1 D Time (s) TiPressure (mmHg) Ti S Fig. 2. Waveform of measured peripheral ABP (black) and the theoretical Windkessel model ABP (gray). Each systolic peak time (Ti S)in the Windkessel ABP is aligned to that of the measured ABP. On a beat-to-beat basis, the Windkessel time constant (τ) is computed so that the beat-MAP of the measured and calculated Windkessel waveforms are equal. 4972 () ( ) ( ) ()() ( )()∑∑ == − + += max 1 2 0 1 0 ,, ,, M M q M q qM MqqM jiXjiXaC jiyjDjiy (9) where M is the model order, MCq is the binomial coefficient, while aMq are the parameters to be found by the linear regression analysis. Once the parameters are obtained, SV is calculated as ()ySV exp= (10) CO is calculated by averaging SV over the six-minute window overlapping every three minutes. B. Experimental Protocol To validate the algorithm, previously reported [10] data from six Yorkshire swine (30–34 kg) recorded under a protocol approved by the MIT Committee on Animal Care were processed and analyzed offline. Aortic blood flow was recorded using an ultrasonic flow probe. Radial and femoral ABP were measured using micromanometer-tipped catheter and an external fluid-filled pressure transducer (TSD104A, Biopac Systems, Santa Barbara, CA). The data were recorded using an A/D conversion system (MP150WSW, Biopac Systems) at a sampling rate of 250 Hz. C. Data analysis The results of the CO and SV estimation were evaluated in terms of the error defined as the logarithm of the ratio of the estimated to measured values. Specifically, root normalized mean square log error (RNMSLE) was used: () ( )()()f N n nn NNMeasEstRNMSLE −−= ∑ =1 2 lnln100 (11) where N is the number of data points, Nf the number of free parameters, Est and Meas are the estimated and measured values of CO and SV. Utilizing the F-test, as in pair-wise comparison of variance, RNMSLE of the new method was compared with the following methods: ARMA technique (CO estimates only) [10], Liljestrand method (Lilje) [8, 18], traditional PP method (PP1), Herd’s PP method (PP2) [7]. The CO and SV estimates by the new method were also compared with constant values (Const) in which the calculated CO and SV are set to constant values (means of the measured CO and SV). The comparison results with P<0.05 were regarded as statistically significant. III. RESULTS Using the MDL criterion [19, 20], the order was set to 8 for analysis of femoral ABP, and the order was set to 9 for analysis of radial ABP. The new method yielded smaller RNMSLE (P<0.05) than the other methods for both the CO and SV estimations (Fig. 3). Over a wide physiological range achieved by administering phenylephrine (vasoconstrictor), nitroglycerin (vasodilator), dobutamine (beta agonist), and esmolol (beta blocker), the new method achieved errors of 12.7% in CO and 16.5% in SV derived from femoral ABP, and 10.1% in CO and 14.5% in SV derived from radial ABP. The overall trend of the measured and estimated CO and SV showed strong agreement (radial results shown in Fig. 4). The correlation coefficients (R) between measured CO (SV) and estimated CO (SV) from femoral ABP was 0.945 (0.914). For CO (SV) derived from radial ABP the correlation coefficients was 0.970 (0.909). IV. DISCUSSION We have introduced a novel algorithm to estimate continuous CO and SV from analysis of peripheral ABP waveforms recorded at the femoral and radial arteries. The new algorithm uses beat-MAP and end-DBP, rather than SBP, values since beat-MAP and end-DBP values are relatively insensitive to distortion in the ABP waveform. The key notion of the new method is that the three dimensionless variables (Ti S/Ti, Pi D/MAPi, and Pi+1 D/MAPi) used to calculate SV were converted into three proportional SV estimates (SVprop1, SVprop2, and SVprop3) using three variants of the Windkessel model (6a-6c). The logarithm of the three SV estimates were weighted by parameters obtained from linear regression and least mean square error analysis, and integrated into a single SV value by (9). The new method achieved RNMSLE of 12.7% in CO and 16.5% in SV derived from femoral ABP, and 10.1% in CO and 14.5% in SV derived from radial ABP, and showed a significant improvement over the other methods (P<0.05, Fig. 3). A limitation of the current methods, along with all PCMs is that SV and CO are all estimated only to within a proportionality constant. An independent calibration is required if absolute measures are needed. 0 10 20 30 40 Const Lilje PP PP2 ARM A NewRNMSLE (%)Femoral ABP Radial ABP * * * ** * * * * (a) Errors in CO derived from femoral ABP and radial ABP 0 10 20 30 40 Const Lilje PP PP2 NewRNMSLE (%)Femoral ABP Radial ABP * * ** * * * * (b) Errors in SV derived from femoral ABP and radial ABP Fig. 3. Errors in CO and SV estimation by method. The error metric is given in (11). Asterisk (*) indicates that the difference in error achieved by the new method (New) compared to the reference method was significant at the P < 0.05 level. 4973 REFERENCES [1] H. Barcroft, O. G. Edholm, J. McMichael, and E. P. Sharpy-Schafer, \"Posthaemorrhagic fainting. Study by cardiac output and forearm flow,\" Lancet, pp. 489-491, 1944. [2] W. Ganz, R. Donoso, H. S. Marcus, J. S. Forrester, and H. J. Swan, \"A new technique for measurement of cardiac output by thermodilution in man,\" Am J Cardiol, vol. 27, pp. 392-6, Apr 1971. [3] G. R. Manecke, Jr., J. C. Brown, A. A. Landau, D. P. Kapelanski, C. M. St Laurent, and W. R. Auger, \"An unusual case of pulmonary artery catheter malfunction,\" Anesth Analg, vol. 95, pp. 302-4, table of contents, Aug 2002. [4] J. S. Vender and H. C. Gilbert, Monitoring the anesthetized patient, 3 ed. Philadelphia: Lippincott-Raven Publishers, 1997. [5] M. Botero, D. Kirby, E. B. Lobato, E. D. Staples, and N. Gravenstein, \"Measurement of cardiac output before and after cardiopulmonary bypass: Comparison among aortic transit-time ultrasound, thermodilution, and noninvasive partial CO2 rebreathing,\" J Cardiothorac Vasc Anesth, vol. 18, pp. 563-72, Oct 2004. [6] M. J. Bourgeois, B. K. Gilbert, G. Von Bernuth, and E. H. Wood, \"Continuous determination of beat to beat stroke volume from aortic pressure pulses in the dog,\" Circ Res, vol. 39, pp. 15-24, Jul 1976. [7] J. A. Herd, N. R. Leclair, and W. Simon, \"Arterial pressure pulse contours during hemorrhage in anesthetized dogs,\" J Appl Physiol, vol. 21, pp. 1864-8, Nov 1966. [8] G. Liljestrand and E. Zander, \"Vergleichende Bestimmung des Minutenvolumens des Herzens beim Menschen mittels der Stickoxydulmethode und durch Blutdruckmessung.,\" Zeitschrift fur die gesamte experimentelle Medizin, vol. 59, pp. 105-122, 1928. [9] N. W. Linton and R. A. Linton, \"Estimation of changes in cardiac output from the arterial blood pressure waveform in the upper limb,\" Br J Anaesth, vol. 86, pp. 486-96, Apr 2001. [10] R. Mukkamala, A. T. Reisner, H. M. Hojman, R. G. Mark, and R. J. Cohen, \"Continuous cardiac output monitoring by peripheral blood pressure waveform analysis,\" IEEE Trans Biomed Eng, vol. 53, pp. 459-67, Mar 2006. [11] J. D. Redling and M. Akay, \"Noninvasive cardiac output estimation: a preliminary study,\" Biol Cybern, vol. 77, pp. 111-22, Aug 1997. [12] K. H. Wesseling, B. De Werr, J. A. P. Weber, and N. T. Smith, \"A simple device for the continuous measurement of cardiac output. Its model basis and experimental verification.,\" Adv Cardiovasc Phys, vol. 5, pp. 16-52, 1983. [13] R. J. Levy, R. M. Chiavacci, S. C. Nicolson, J. J. Rome, R. J. Lin, M. A. Helfaer, and V. M. Nadkarni, \"An evaluation of a noninvasive cardiac output measurement using partial carbon dioxide rebreathing in children,\" Anesth Analg, vol. 99, pp. 1642-7, table of contents, Dec 2004. [14] M. F. O'Rourke, R. P. Kelly, and A. P. Avolio, The Arterial Pulse: Lea & Febiger, 1992. [15] M. W. Mohiuddin, G. A. Laine, and C. M. Quick, \"Increase in pulse wavelength causes the systemic arterial tree to degenerate into a classical windkessel,\" Am J Physiol Heart Circ Physiol, vol. 293, pp. H1164-71, Aug 2007. [16] M. J. Bourgeois, B. K. Gilbert, D. E. Donald, and E. H. Wood, \"Characteristics of aortic diastolic pressure decay with application to the continuous monitoring of changes in peripheral vascular resistance,\" Circ Res, vol. 35, pp. 56-66, Jul 1974. [17] P. Hallock and I. C. Benson, \"Studies on the Elastic Properties of Human Isolated Aorta,\" J Clin Invest, vol. 16, pp. 595-602, Jul 1937. [18] J. X. Sun, A. T. Reisner, M. Saeed, T. Heldt, and R. G. Mark, \"The cardiac output from blood pressure algorithms trial,\" Crit Care Med, vol. 37, pp. 72-80, Jan 2009. [19] J. Rissanen, \"Modeling by shortest data description,\" Automatica, vol. 14, pp. 465-471, 1978. [20] M. H. Perrott and R. J. Cohen, \"An efficient approach to ARMA modeling of biological systems with multiple inputs and delays,\" IEEE Trans Biomed Eng, vol. 43, pp. 1-14, Jan 1996. 1 2 3 4 5 6 7 0 20 40 60 80 100 120 140 160 Six-minute windows(L/min) M easured Estimated from radial A BP (a) Measured CO (black circles) and estimated CO (white triangles) from radial ABP. R = 0.970 0 10 20 30 40 50 60 0 10000 20000 30000 40000 50000 60000 Beats[L/min] .Measured Estimated from Radial ABP (b) Measured SV (black line) and Estimated SV (gray line) from radial ABP. R = 0.909 Fig. 4. Agreement of the measured and estimated cardiac output (CO) and stroke volume (SV) from radial arterial blood pressure in six Yorkshire swine. 4974","libVersion":"0.2.3","langs":""}