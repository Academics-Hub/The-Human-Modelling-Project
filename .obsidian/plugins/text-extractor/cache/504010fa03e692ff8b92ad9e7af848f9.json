{"path":"Papers/Biomedical Engineering papers/Enhancing Blood Glucose Prediction with Meal Absorption and Physical Exercise Information.pdf","text":"arXiv:1901.07467v1 [q-bio.TO] 13 Dec 2018 1 Enhancing Blood Glucose Prediction with Meal Absorption and Physical Exercise Information Chengyuan Liu, Josep Veh´ı, Nick Oliver, Pantelis Georgiou and Pau Herrero Abstract—Objective: Numerous glucose prediction algorithm have been proposed to empower type 1 diabetes (T1D) manage- ment. Most of these algorithms only account for input such as glu- cose, insulin and carbohydrate, which limits their performance. Here, we present a novel glucose prediction algorithm which, in addition to standard inputs, accounts for meal absorption and physical exercise information to enhance prediction accuracy. Methods: a compartmental model of glucose-insulin dynamics combined with a deconvolution technique for state estimation is employed for glucose prediction. In silico data corresponding from the 10 adult subjects of UVa-Padova simulator, and clinical data from 10 adults with T1D were used. Finally, a comparison against a validated glucose prediction algorithm based on a latent variable with exogenous input (LVX) model is provided. Results: For a prediction horizon of 60 minutes, accounting for meal absorption and physical exercise improved glucose forecasting accuracy. In particular, root mean square error (mg/dL) went from 26.68 ± 3.58 to 23.89 ± 3.32, p < 0.001 (in silico data); and from 37.02 ± 5.14 to 35.96 ± 4.65, p < 0.001 (clinical data - only meal information). Such improvement in accuracy was translated into signiﬁcant improvements on hypoglycaemia and hyperglycaemia prediction. Finally, the performance of the proposed algorithm is statistically superior to that of the LVX algorithm (26.68 ± 3.58 vs. 32.80 ± 4.58, p < 0.001 (in silico data); 37.02 ± 5.14 vs. 49.17 ± 13.80 p < 0.01 (clinical data). Conclusion: Taking into account meal absorption and physical exercise information improves glucose prediction accuracy. Index Terms—Diabetes, glucose prediction, deconvolution, ar- tiﬁcial pancreas. I. INTRODUCTION T YPE 1 diabetes mellitus (T1DM) is an autoimmune condition characterized by elevated blood glucose levels due to the lack of endogenous insulin production [1]. People with T1DM require exogenous insulin delivery to regulate glucose levels. Current therapies for T1DM management re- quire measuring capillary glucose levels several times per day and the administration of insulin by means of multiple daily injections (MDI) or continuous subcutaneous insulin infusion (CSII) with pumps. More recently, the appearance of subcutaneous continuous glucose monitoring (CGM) al- lows access to virtually continuous glucose concentrations measurements (e.g. every 5 minutes), glucose rate-of-change, and allows their retrospective analysis. In addition, real-time devices include alerts and alarms for concentrations outside C. Liu, P. Georgiou and P. Herrero are with the Centre for Bio-Inspired Technology, Department of Electrical and Electronic Engineering, Imperial College London, London SW7 2AZ, UK. E-mail: pherrero@imperial.ac.uk. J. Veh´ı is with Department of Electrical and Electronic Engineering, Universitat de Girona and with CIBERDEM, Girona, 17004, Spain. N. Oliver is with Charing Cross Hospital, Imperial College Healthcare NHS Trust, London W6 8RF, UK. of speciﬁed ranges and or rapid changes in glucose. Clinical data suggest that CGM can improve overall glucose control, as measured by glycated haemoglobin [2], and can reduce the burden of extreme glucose values (hypo- and hyperglycaemia) [3]. In addition, CGM technology has opened the door to new technologies for managing glucose levels such as sensor- augmented insulin pumps with low-glucose insulin suspension [4] and the artiﬁcial pancreas [5]. One important feature of CGM-based technologies is the ability to forecast glucose concentrations in order to avoid undesired events, such as hypoglycaemia and hyperglycaemia, by enabling pre-emptive action (e.g. insulin dose to address hyperglycaemia). Several glucose forecasting algorithms have been proposed by different authors, with a comprehensive and extensive review being recently published, which provides a taxonomy of the different types of existing algorithms [6]. In addition, commercial applications of such technology already exists in the form of sensor-augmented insulin pumps (e.g. Medtronic MiniMed 640G with Smart Guard) that has been proven to reduce nocturnal hypoglycaemia using predictive glucose alerts and a predictive low-glucose insulin suspension system [4]. Some glucose prediction algorithms use continuous glucose monitoring (CGM) data as the unique source of information to forecast glucose levels while others use additional exogenous inputs such as meal intake and insulin injections, which are know to inﬂuence blood glucose levels [6]. Taking such infor- mation into account has been proven to improve forecasting accuracy [7]. Furthermore, additional information such as meal absorption and physical exercise information can potentially further improve accuracy [8], [9]. In this work, we introduce a novel model-based glucose prediction algorithm which uses deconvolution of the CGM signal to estimate some model states in order to improve prediction accuracy. In addition to using CGM data, insulin bo- luses and carbohydrate intake information, information about meal absorption and physical exercise is taken into account to further enhance prediction accuracy. For comparison purposes, the latent variable with exogenous input (LVX) algorithm proposed by Zhao et al. has been selected as reference in glucose forecasting since it has showed superiority when compared against existing techniques in the literature and its source code is publicly available [7]. The proposed algorithm is evaluated for different prediction horizons ranging from 5 to 120 minutes, with special focus on the 60-minute horizon [6]. Finally, predictive hypoglycaemia and hyperglycaemia prediction capabilities of the tested algorithms are evaluated. For testing purposes, the UVa-Padova type 1 diabetes sim- 2 ulator (T1DMS) [10] was extended in order to include a physical exercise model, a richer meal-model library and intra- day variability. In addition, a two-week clinical dataset from a cohort of 10 adult subjects with T1DM was employed. Finally, the performance of the tested algorithms was evaluated by means of root mean square error (RMSE) and Clarke Error Grid Analysis (EGA). II. METHODS The proposed glucose prediction algorithm is based on composite minimal model of glucose-insulin regulation in type 1 diabetes [11] that uses deconvolution of the continuous glucose monitoring (CGM) signal to estimate some of the model states. In particular, the states of the gastrointestinal model are estimated using the technique proposed by Herrero et al. [12], which has been proved to be a simple but effective way to estimate the glucose rate of appearance from mixed meals. Finally, meal information (i.e., carbohydrate amount and absorption type), insulin boluses and physical exercise are considered as exogenous inputs. Note that compared to the model used in the T1DM simulator, the employed composite minimal model is relatively simple and easy to identify, while providing sufﬁcient complexity to model glucose-insulin dynamics. The effectiveness of such composite model was evaluated by Gillis et al. for glucose prediction using a Kalman ﬁlter technique [13] and by Herrero and associates for detecting faults in insulin pump therapy [11]. A. Composite minimal model The employed composite model of glucose regulation in type 1 diabetes is composed of the minimal model of glucose disappearance proposed by Bergman and colleagues [14], and the insulin and carbohydrate absorption models proposed by Hovorka et al.[15]. 1) Minimal model of glucose disappearance: The minimal model of glucose disappearance [14] is described by the equations ˙G(t) = −(SG + X(t))G(t) + SGGb + Ra(t) 3 0 100 200 300 400 500 600 Time (min) 0 1 2 3 4 5 6 7 8Ra (mg/min) fast medium slow Fig. 1: Ra proﬁles corresponding to the fast, slow and medium meals of the employed UVa-Padova simulator for a 60 grams intake of carbohydrates. follows tmaxG :=    to maxG − tl, fast absorption to maxG, medium absorption to maxG + td, slow absorption (9) where to maxG is the default time-to-maximum absorption rate (i.e. medium absorption) for a given subject, tl and td represent the time shift on the time-to-maximum absorption rate due to different meal absorption rates. In particular, tl and td were empirically ﬁxed to 20 minutes. Fig. 1 shows the average Ra proﬁles corresponding to the fast, slow and medium meals of the employed UVa-Padova simulator for a 60 grams intake of carbohydrates. B. Glucose prediction algorithm The proposed glucose prediction algorithm uses a discre- tised version of the presented composite model (Equations 1-7). For this purpose, a forward Euler’s Conﬁguration with 1-minute step size is used to simulate the model. Let x(k) = f (x(k − 1), p, u(k − 1)) be the system equations representing a discre- tised version of the described composite model, where k denotes the sampling instant. Let x =[G X S1 S2 I Ra1 Ra] represent the model states; p = [ke tmaxI Vi Ag tmaxG SG p2 W V SI ] repre- sent the model parameters; and u = [ CHO IB EX MA] represent the model inputs, where CHO denotes the amount of ingested carbohydrates, IB denotes the insulin boluses (units), EX denotes an exercise ﬂag (i.e. true or false) and MA denotes the meal absorption (i.e. slow, medium, fast). To improve the forecasting capability of the proposed algo- rithm, the model states of the gastrointestinal sub-model (Ra and Ra1) are estimated in real-time (e.g. every 5 minutes) by doing a deconvolution of the continuous glucose monitoring signal using the technique proposed by Herrero et al. [12]. Such models estates were selected for being highly dependent on meal composition. The glucose rate of appearance (Ra) in the second compartment is estimated as ˆRa(k) = [ ˙G(k) + (SG + X(k)) ¯G(k) − SGGb] V W, (10) where ˙G is the derivative of the glucose measurements calcu- lated as the slope of the linear regression of three consecutive glucose values, ¯G is the sensor measurement and X is the insulin action (Equation 2). In order to reduce the inﬂuence of the measurement disturbance, the derivative is bounded by | ˙G| ≤ 1 mg/dL per min. To further reduce the effect of sensor noise on the ˆRa estimation, a moving average ﬁlter is applied, ˆRa(k) := ∑i=k i=k−n Ra(i) + ˆRa(i) 4 Vi, ke, p2, Ag) [18], while others were set by using a priori known information from the subjects, such as body weight (W ) and basal glucose (Gb). Finally, parameters SI , tmaxI and tmaxG were identiﬁed by minimising the mean absolute relative difference (MARD) between the predicted glucose (Gf ) and the corresponding glucose measurements. Matlab fmincon constrained optimisation routine was employed for this purpose. Constraints for the identiﬁed parameters were SI ∈ [0.001, 0.005] min−1 per µU/ml, tmaxI ∈ [50, 140] min and tmaxG ∈ [50, 140] min. Table I shows the employed values for the model parameters indicating which ones are a priori known and which ones are identiﬁed. D. In silico testing The latest version of the UVa-Padova T1DM simulator (v3.2) [10] was used to evaluate the proposed glucose fore- casting algorithm. The 10 available adult subjects were used for this purpose. The open-loop insulin therapy provided by the simulator was employed to generate the datasets. A one- week scenario with a daily pattern of carbohydrate dose intake of 7am (70g), 13pm (100g) and 7pm (80g) (±20min) was chosen. The selected CGM and insulin pump models to perform the simulations were the Dexcom G4 and Deltec Cozmo. Intra-day variability was emulated by modifying some of the parameters of the model described in [19]. In particular, meal variability was emulated by introducing meal-size variability (CV = 10%), meal-time variability (ST D = 20) and un- certainty in the carbohydrate estimation (uniform distribution between −30% and +20%) [20]. Meal absorption rate (kabs) and carbohydrate bioavailability (f ) were considered to vary by ±30% and ±10% respectively. To account for variability in meal composition, the 33 available meals in the simulator were considered. Note that each cohort had 11 different meals (i.e. 10 individuals plus an average individual). In addition, 16 mixed meals obtained from clinical data extracted from scientiﬁc publications were included. A mixed-meal model library was obtained using the technique for estimating the rate of glucose appearance proposed by Herrero et al. in [12], [21]. Details about the meal library are provided in Appendix A. By using the absorption classiﬁcation criteria introduced in Section II-A5, of the 49 considered meal, 31 were clas- siﬁed as fast absorption, 15 as medium absorption and 3 as slow absorption. Intra-subject variability in insulin absorption model parameter (kd, ka1, ka2) was assumed ±30% [22], [23]. Finally, physical exercise was introduced as described in [17]. In particular, a 30-minute exercise CV = 10% at 50% VO2max was considered at 3pm (±20min). In order to test the beneﬁt of accounting for meal and exer- cise information in the glucose predictions, four conﬁgurations of the proposed algorithm were considered. These are: • Conf iguration 1: exercise and meal type information (i.e. slow, medium, fast) are not taken into account. • Conf iguration 2: only exercise information is taken into account. • Conf iguration 3: only meal type information is taken into account. • Conf iguration 4: both meal type and exercise informa- tion are taken into account. The latent variable model with exogenous input (LVX) algorithm proposed by Zhao et al. [7] was chosen to compare its performance against the proposed technique. Finally, in order to train both the proposed algorithm and the LVX algorithm, a one-week training dataset, different from the testing scenario, was employed. E. Clinical data testing Although signiﬁcant intra-day variability was considered in the selected in silico scenario, it still cannot be compared to a real-life scenario. In order to test the proposed algorithm with real clinical data, a one-week clinical dataset from the 10 adult subjects with T1DM undergoing a clinical trial evaluating the beneﬁts of an advanced insulin bolus calculator was employed [24]. Since no reliable information about physical exercise and meal composition was available for the clinical dataset, the proposed algorithm was evaluated making the assumption that breakfast is fast absorption and lunch and dinner are medium absorption (i.e. Conﬁguration 3). Not that not having such information in a reliable way might limit the beneﬁts of the proposed algorithm. Finally, the algorithm without considering information about meal absorption and exercise (i.e. Conf iguration 1) and the LVX algorithm were also evaluated and compared. Two different one-week datasets were employed for training and testing purposes. F. Evaluation metrics In order to evaluate the forecasting accuracy of the algo- rithms, the root mean square (RMSE) and the percentage of values in A-region of the Error Grid Analysis (EGA) were used. RMSE is calculated as RM SE = √ 5 TABLE I: Values of the parameters used in the forecasting algorithm. ∗ indicates parameters that are identiﬁed and ∗∗ parameters that are known from a priori information from the subjects. The rest of the parameters are ﬁxed to mean population values obtained from the scientiﬁc literature [12], [15]. 6 TABLE II: RMSE (mg/dL) and A-region of the EGA (%) expressed in M ean ± ST D for the four considered conﬁgurations and the LVX algorithm corresponding to different prediction horizon (P H in minutes) and evaluated on the 10-adult virtual population. The statistical signiﬁcance with respect to the row below is indicated with ∗ for p < 0.001, + for p < 0.01 and T for p < 0.05 . 7 TABLE IV: RMSE (mg/dL) and A-region of EGA (%) expressed (M ean ± ST D) for Conf iguration 3, Conf iguration 1 and the LVX algorithm corresponding to different prediction horizon (P H in minutes) and evaluated on the 10 adult subjects. The statistical signiﬁcance with respect to the row below is indicated with ∗ for p < 0.001, + for p < 0.01 and T for p < 0.05 . 8 TABLE VI: Mixed meals information and bibliographic references. 9 TABLE VII: Gastrointestinal model parameters corresponding to the 16 selected mixed meals. Coefﬁcient of variation (%) provided by the Matlab lsqnonlin optimization routine is reported in brackets. 10 a mixed-meal model library to in silico optimization of insulin titration algorithms,” in Diabetes Technology Meeting, San Francisco, USA, 2013. [22] A. Haidar, D. Elleri, K. Kumareswaran, L. Leelarathna, J. M. Allen, K. Caldwell, H. R. Murphy, M. E. Wilinska, C. L. Acerini, M. L. Evans et al., “Pharmacokinetics of insulin aspart in pump-treated subjects with type 1 diabetes: reproducibility and effect of age, weight, and duration of diabetes,” Diabetes care, vol. 36, no. 10, pp. e173–e174, 2013. [23] P. Herrero, J. Bondia, O. Adewuyi, P. Pesl, M. El-Sharkawy, M. Reddy, C. Toumazou, N. Oliver, and P. Georgiou, “Enhancing automatic closed- loop glucose control in type 1 diabetes with an adaptive meal bolus calculator–in silico evaluation under intra-day variability,” Computer methods and programs in biomedicine, 2017. [24] M. Reddy, P. Pesl, M. Xenou, C. Toumazou, D. Johnston, P. Georgiou, P. Herrero, and O. Nick., “Clinical safety and feasibility of the advanced bolus calculator for type 1 diabetes based on case-based reasoning: A 6- week nonrandomized single-arm pilot study,” Diabetes technology and therapeutics, vol. 18, no. 8, pp. 487–493, 2016. [25] I. M. Wentholt, J. B. Hoekstra, and J. H. DeVries, “A critical appraisal of the continuous glucose–error grid analysis,” Diabetes Care, vol. 29, no. 8, pp. 1805–1811, 2006. [26] “PEPPER: Patient empowerment through predictive personalised decision support,” accessed: 2017-12-01. [Online]. Available: http://www.pepper.eu.com [27] C. Dalla Man, K. E. Yarasheski, A. Caumo, H. Robertson, G. Toffolo, K. S. Polonsky, and C. Cobelli, “Insulin sensitivity by oral glucose min- imal models: validation against clamp,” American journal of physiology - endocrinology and metabolism, vol. 289, no. 6, pp. E954–E959, 2005. [28] J. Galgani, C. Aguirre, and E. D´ıaz, “Acute effect of meal glycemic index and glycemic load on blood glucose and insulin responses in humans,” Nutrition journal, vol. 5, no. 1, p. 22, 2006. [29] S. Normand, Y. Khalfallah, C. Louche-Pelissier, C. Pachiaudi, J.-M. Antoine, S. Blanc, M. Desage, J. P. Riou, and M. Laville, “Inﬂuence of dietary fat on postprandial glucose metabolism (exogenous and endogenous) using intrinsically 13 c-enriched durum wheat,” British journal of nutrition, vol. 86, no. 1, pp. 3–11, 2001. [30] G. Freckmann, S. Hagenlocher, A. Baumstark, N. Jendrike, R. C. Gillen, K. R¨ossner, and C. Haug, “Continuous glucose proﬁles in healthy subjects under everyday life conditions and after different meals,” Journal of diabetes science and technology, vol. 1, no. 5, pp. 695–703, 2007. [31] J. C. Brand-Miller, V. Liu, P. Petocz, and R. C. Baxter, “The glycemic index of foods inﬂuences postprandial insulin-like growth factor–binding protein responses in lean young subjects,” The American journal of clinical nutrition, vol. 82, no. 2, pp. 350–354, 2005. [32] T. E. Edes and J. H. Shah, “Glycemic index and insulin response to a liquid nutritional formula compared with a standard meal,” Journal of the American College of Nutrition, vol. 17, no. 1, pp. 30–35, 1998. [33] C. Koutsari, D. Malkova, and A. E. Hardman, “Postprandial lipemia after short-term variation in dietary fat and carbohydrate,” Metabolism, vol. 49, no. 9, pp. 1150–1155, 2000. [34] H. A. Whitley, S. M. Humphreys, J. S. Samra, I. T. Campbell, D. P. Ma- claren, T. Reilly, and K. N. Frayn, “Metabolic responses to isoenergetic meals containing different proportions of carbohydrate and fat,” British journal of nutrition, vol. 78, no. 1, pp. 15–26, 1997. [35] T. M. Wolever and C. Mehling, “Long-term effect of varying the source or amount of dietary carbohydrate on postprandial plasma glucose, insulin, triacylglycerol, and free fatty acid concentrations in subjects with impaired glucose tolerance,” The American journal of clinical nutrition, vol. 77, no. 3, pp. 612–621, 2003. [36] C. Dalla Man, M. Camilleri, and C. Cobelli, “A system model of oral glucose absorption: validation on gold standard data,” IEEE transactions on biomedical engineering, vol. 53, no. 12, pp. 2472–2478, 2006.","libVersion":"0.2.3","langs":""}