{"path":".obsidian/plugins/text-extractor/cache/e01da7192b10eaeb5da17aad5fa1154d.json","text":"ELEN3014 Biomedical Signals, Systems and Control Chapter 2 Sampling and Reconstruction Theorem 1 2 Sinusoids in the Time and Frequency Domains Time Domain Frequency Domain AMPLITUD E TIME T1=1/f 1 FREQUENCY AMPLITUD E f 1 AMPLITUD E TIME T2=1/f 2 AMPLITUD E FREQUENCY f 2 T = period (s) f = frequency (Hz) = 1/T discrete n E.jo kl8cn k yin Extra hin unit Fest type signal similar to test charge in magnetic fields a man Any signal decomposed set of impulses superposition delta fane 3 Signals in the time and frequency domains TIM E AMPLITUD E Real life signals are a combination of many frequencies AMPLITUD E FREQUENCY - fm f m |A| 2fm-Band limited Band limited signals representation in frequency domain is always symmetric 4 Samplin g Sampling Time – The time taken to capture a sample Sampling Period – The period between samples 1 4 1 2 3 4 5 6 7 8 9 1 0 11 1 2 1 3TIM E 0 0. 2 0. 4 0. 6 0. 8 1 1. 2 1. 4 1. 6 1. 8 2 itinerate u 5 t sampl e & hol d t s 8t s 4t s Signal = 10 10 01 01 00 00 01 t s 8t s 4t s t 0 0 0 1 1 0 11 quantiz e t s 8t s 4t s t 0 0 0 1 1 0 11 ? ? ? Digitizing the Signal ➢ Sample signal periodically ➢ Hold sampled value until next sample ➢ Classify new signal into levels (quantize the signal) ➢ More levels means more accuracy ➢Aim: to obtain 1, 0 representation sample hold get value and holdtill next measurement Nt m as a seed to Toft to asif m ed w d quantize the signal into bits w y f Thither igner of r lower s represented in bits discrete afeedtiflyurontrofott depending on resolution 6 Signal Ambiguity in the Frequency Domain There is a frequency-domain ambiguity associated with discrete-time signal samples that does not exist in the continuous signal word. ( ) x t f t= s i n ( )2 0 π Signal whose frequency is f0 Let’s sample x(t) at at a rate of fs ( ) ( ) x n f n T T f s s s = =s i n 2 1 0 π ; we lose the identity of the signal when sampling to I Toted its discrete form 7 cont’d ( ) ( ) ( ) ( ) ( )( ) ( ) ( ) ( )( ) sss sss s s s ss n Tm ffn Tfnx n Tm ffn T T m fnx m n k m nknk n T n T k fkn Tfn Tfnx +== += ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ += = ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ ⎟ ⎟ ⎠ ⎞ ⎜ ⎜ ⎝ ⎛ +=+== 00 00 000 2s i n2s i n 2s i n2s i n w i t h r e p l a c ec a n w e, , o fi n t e g e r a n b e l e t w ei f 2s i n22s i n2s i n ππ ππ ππππ ➢ The f0 and f0+mfs factors are therefore equal - > Ambiguity! ➢ When sampling at a rate of fs, if m is any positive or negative integer, we cannot distinguish between the sampled values godicity of a sinusoid similar to proving linearity Half proof of concept 8 Sampling ->Ambiguity Example 7-kHz sinwave 1-kHz sinwave Sampling a 7kHz and 1kHz sinewave at a sample rate of 6kHz Discrete time sequence of values of a sine wave of to Hz and a sine wave of fonts Hz Ambiguity (cont.) 9 ● (a) and (b) are different signals ● But they coincide at the sampling points! a b u mu w 10 Sampling ->Replicated spectrum: TIM E AMPLITUD E FREQUENCY |A| - fm f m 2fm-Band limited Continues spectrum F TIM E AMPLITUD E F Discrete spectrum Band of Interest replicareplica replica f s 2f s - fs FREQUENCY - fs/2 fs/ 2 NT y I 11 Replicated spectrum ➢ for a signal with a finite bandwidth ➢ If the sampling rate is high enough ➢ the replicas are spaced apart far enough Replicas don’t overlap ↔ “no aliasing” 12 Replicated spectrum (cont’d) Replicas overlap ↔ “aliasing” ➢ if the sampling rate is too low ➢ the replicas overlap 13 The sampling theorem ➢ The signal x(t) must be band-limited: its frequency spectrum must be limited to contain frequencies up to some maximum frequency, fmax. ➢ The sampling rate fs must be at least twice the maximum frequency fmax. I n t e r v a lN y q u i s t ff R a t eN y q u i s tff ff ss s s 2 , 2 t h ec a l l e d i s 2 r a t e s a m p l i n g m i n i m u m t h e 2 m a x m a x = ⎥ ⎦ ⎤ ⎢ ⎣ ⎡ − = ≥ 14 DSP Applications Application fmax fs geophysical Biomedical mechanical speech audio video 500Hz 1kHz 2kHz 4kHz 20kHz 4MHz 1kHz 2kHz 4kHz 8kHz 40kHz 8MHz 15 Anti Aliasing Pre- Filter ➢ When the sampling frequency is too low ➢ It’s better to remove some bandwidth with an LPF: ⇒ fs/2-fs/2 →loss of information but no aliasing! fma x - fma x x(f) Input spectrum ⇒ - fs/2 fs/ 2prefiltered spectrum x(f) Information loss vs. aliasing 16 ω ∑ ∞ − ∞= − n sa nX )( ωω •••••• Without “aliasing” ω ∑ ∞ − ∞= − n sa nY )( ωω •••••• s ω )()()( ωωω L P Faa HXY ⋅= ω 2/ s ω2/ s ω− s ω− s ω s ω− )( ω a X ω 0 ω 0 ω− ⇒ ⇒ With “aliasing” \u0000=2\u0000f The aliasing Effect ● To calculate mathematically the effect of aliasing we employ the following process: ➢ For each frequency component f in the replicated sets, there is a unique one that lies inside the Nyquist Interval. ➢ These frequencies can be mathematically described by the modulo operation on each original f with the mod fs – the sampling frequency, ➢ We denote this by: fa=fmod(fs) ➢ therefore these frequencies are “folded back” to the sampling interval” – we add to or subtract from f enough multiples of fs until it reaches the range within the symmetric Nyquist interval. 17 original Mts 18 Anti-Aliasing LP prefilter DSPADC DAC Typical Digital Signal Processing Xin(t ) analo g signal fm ax - fma x x(f) input spectrum x(t ) bandlimited analog signal cutoff fmax=fs/2 rate fs - fs/2 fs/2 prefiltered spectrum x(f) x(nTs ) digital signal •••••• f s - fs replicate d spectrum 19 Ideal Analog Reconstruction ➢ an ideal analog re-constructor implements two operations: 1. Extracts from the sampled signal all the frequency components that are inside the Nyquist Interval, and remove all frequencies outside that interval (using a LPF with cutoff frequency fs) 2. Performs an inverse Fourier transform on the filtered signal to produce a time domain signal ELEN3014 Biomedical Signals, Systems and Control 20 Exercises Problems due to sampling Ambiguity replicas of spectrum LPF solution Aliasing overlapping of replicated spectrums depends on sampling freq etc LPFpre sampling solution see Nyquist theorem I also applying nyquist ie raise sampling free till no more aliasing 21 Exercise: 1. The following 5 signals, where t is in seconds, are sampled at a rate of 4Hz: Show that they are all aliased with each other. ( ) ( ) ( ) ( ) ( ) − −s i n , s i n , s i n , s i n , s i n1 4 6 2 1 0 1 8π π π π πt t t t t att so move to freq domain foriginal mfs 7 4m 2,2 3 4m m l i me 2 I ng o t 427 1 ftp IIIFI s.aiasedwimsincaat aliased with sina.tt q 4m a m 2 yen foriginal mfs 5 4m i met in w ggg that each signal is 4 z apart aliased with silat we can predict their aliasing since they are all aliased with sincutt they are all aliased with eachother a fs 2tmax fmax 115 fs 3 b choose fs 4Hz if fs 2Hz µ my 4 4 any 14,1141 12,11 Solution ● The signals are: ● The frequencies corresponding to the sinusoid signals are -7Hz , -3Hz, 1Hz, 5Hz and 9Hz , respectively Those frequencies are 4Hz apart from each other – so if the signals are sampled by fs=4Hz, all these signals are aliased with each other! We proved that due to sampling: Therefore if we choose f0=1Hz - the middle sinusoid, then for m=-1 f=f0+mfs=-3Hz for m=2 f=f0+mfs=9Hz …etc. 22 ( ) ( ) ( ) ( ) ( ) − −s i n , s i n , s i n , s i n , s i n1 4 6 2 1 0 1 8π π π π πt t t t t ( )( ) ( )( ) sss n Tm ffn Tf += 00 2s i n2s i n ππ 23 Exercise: 2. Let x(t) be the sum of sinusoidal signals (t is in ms): a. Determine the minimum sampling rate that will not cause any aliasing effects. b. Plot the resulting spectrum of the signal sampled at a rate higher than the one found in a) To observe such aliasing effects, suppose this signal is sampled at half the rate found in a): c. Determine the signal xa(t) that would be aliased with x(t). ( ) ( ) ( ) ttttx πππ 3c o s2c o s2c o s34)( +++= Solution a) The frequencies in the signal: Are 0, 0.5, 1 and 1.5 kHz. Here is the spectrum plot: The largest frequency, fmax which corresponds to its Bandwidth, is 1.5kHz. Niquist’s theorem states that choosing fs\u00002*fmax will assure no aliasing distortion. Therefore fs=2*fmax=3kHz is the minimal one that will provide no distortion. 24 ( ) ( ) ( ) ttttx πππ 3c o s2c o s2c o s34)( +++= F [kHz] X(f) 0 1-1 1.5-1.5 fma x Solution (cont) b) The resulting spectrum of sampling with a sampling rate 4Hz (larger than the minimal Niquist rate: Replicas – but no distortion! 25 ( ) ( ) ( ) ttttx πππ 3c o s2c o s2c o s34)( +++= 0 F [kHz] Xs(f) 1-1 2 3 4-2 6 Solution (cont) c) if we choose half this rate 26 0 F [kHz] Xs(f ) 1-1 2 3 4-2 6 New sampling interval First replica After sampling-> fnew=fold- mfs 27 0 F [kHz] Xs(f) 1-1 2 3 4-2 6 New sampling interval First replica . . . . .. . . Solution (cont) The sampling resulted in an aliased and distorted signal: 28 0 F [kHz] Xr(f) 1-1 2 3 4-2 Low pass filter Solution (cont) The reconstructor will cut out the replicas and yield Xr(f) but will not be able to retrieve the original signal: Inverse Fourier transform will yield : ( ) ( ) tttx ππ 2c o s2c o s44)( ++=","libVersion":"0.2.2","langs":""}