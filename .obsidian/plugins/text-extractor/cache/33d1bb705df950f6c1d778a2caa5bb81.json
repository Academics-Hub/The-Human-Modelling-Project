{"path":"Papers/Biomedical Engineering papers/Windkessel Model Analysis in MATLAB.pdf","text":"WINDKESSEL MODEL ANALYSIS IN MATLAB Ing. Martin HLAVÁČ, Doctoral Degree Programme (3) Dept. of Biomedical Engineering, FEEC, BUT E-mail: hlavacm@feec.vutbr.cz Supervised by: Prof. Jiří Holčík ABSTRACT This paper briefly describes three Windkessel models and demonstrates application of Matlab® for mathematical modelling and simulation experiments with the models. Windkessel models are usually used to describe basic properties vascular bed and to study relationships among hemodynamic variables in great vessels. Analysis of a systemic or pulmonary arterial load described by parameters such as arterial compliance and peripheral resistance, is important, for example, in quantifying the effects of vasodilator or vasoconstrictor drugs. Also, a mathematical model of the relationship between blood pressure and blood flow in the aorta and pulmonary artery can be useful, for example, in the design, development and functional analysis of a mechanical heart and/or heart-lung machines. We found that ascending aortic pressure could be predicted better from aortic flow by using the four-element windkessel than by using the three-element windkessel or two-elment windkessel. The root-mean-square errors were smaller for the four-element windkessel. 1 INTRODUCTION The first description of a Windkessel model was given by the German physiologist Otto Frank in an article published in 1899 [1]. The model has been applied recently in studies of chick embryo [2] and rat [3]. It expresses heart and systemic arterial system as a closed hydraulic circuit comprising a water pump connected to a chamber. The circuit is filled with water except for a pocket of air in the chamber. (Windkessel is a German word for air- chamber.) As water is pumped into the chamber, the water both compresses the air in the pocket and pushes water out of the chamber, back to the pump. The compressibility of the air in the pocket simulates the elasticity and extensibility of the major artery, as blood is pumped into it by the heart ventricle. This effect is commonly referred to as arterial compliance. The resistance water encounters while leaving the Windkessel and flowing back to the pump, simulates the resistance to flow encountered by the blood as it flows through the arterial tree from the major arteries, to minor arteries, to arterioles, and to capillaries, due to decreasing vessel diameter. This resistance to flow is commonly referred to as peripheral resistance. 2 METHOD Fig. 1. shows three basic Windkessel models (WM), that are used for modelling hemodynamic state. The simplest model (Fig. 1a) is able to calculate only basic exponential pressure curve determined only by values of diastolic and systolic pressure. The 4-element model (Fig.4c) generates more accurate curves, but calculations are more complicated than for the model in Fig.1a. When deciding which model is to be used it is necessary to take into account several various criteria and rules as computational complexity of the model, required shape of produced curve, etc. Assuming the ratio of blood pressure to blood volume in the chamber constant and that the flow of fluid through the pipes connecting the air chamber to the pump follows the Poiseuille's law and is proportional to the fluid pressure. a)2WM b)3WM c)4WM Fig. 1: Three basic Windkessel models 2.1 THE TWO-ELEMENT WINDKESSEL MODEL Figure 1a shows the 2-element WM that consists of parallel connection of resistor and capacitor only. Resistor R represents total peripheral resistance and capacitor C stands for compliance of veins. This simple model of arterial bed allows only a rough approximation to real system. The model is described by following differential equation: dt tdu C R tu ti )()( )(1 += (1). 2.2 THE THREE-ELEMENT WINDKESSEL MODEL Another model of the circulatory system is a Broemser model, which was described by the Swiss physiologists Ph. Broemser and Otto F. Ranke in an article published in 1930 [4]. It is also known as the 3-element Windkessel model. In comparison with the 2-element WM this model uses another resistive element in between the pump and the air-chamber to simulate resistance to blood flow due to the aortic or pulmonary valve. The 3-element model (Fig. 1.b) is usually exploited at studies of general characteristics of the arterial system. The differential equation defining properties of the 3-element WM is as it follows: dt tdu C Rtu ti CC )()( )(1 += (2) 2.3 THE FOUR-ELEMENT WINDKESSEL MODEL The 4-elements model (Fig. 1.c) includes inductance L, which represents inertia of blood flow (neglected in the 2- and 3- element WM). This model offers relatively good approximation to real system. The model is defined by two differential equations: )()( )( )( 1 )( 1)( 1 1 ti L r ti L r dttdi ti C tu RCdt tdu L L C C +−= +−= (3) 3 EXPERIMENTS We have built the three mentioned Windkessel models in MATLAB ® and its supplement SIMULINK. The input signal was used the flow of blood across aorta. This curve can be divided to two parts. The first one represents the cardiac issue in systola and we can approximate this part the curve by a sine wave. The second part of the input curve is equal to zero, that is the circuit is disconnected from the current source (closed heart valve). Figure 2 depicts the input flow curve in case that the blood flow to the aorta and pulmonary artery is given as: , 0, 0 sin* \\ / )( 2 0 TT T T t I ti S S S ∈ ∈       ⋅ = τ τπ Fig. 2: Blood flow (I0=500ml, TS=0.3s, T=0.8s) Tab. 1: The values of normal human parameters of the Windkessel models R C r L [mmHg.s.cm -3] [cm 3.mmHg-1.s2.cm -3] [mmHg.s.cm -3] [mmHg.s2.cm -3] 2 WM 1 1 - - 3 WM 1 0.79 0.63 1 1.75 5.16 0.05 0.033 0.03 - 4 WM 1 0.79 0.63 1 1.22 2.53 0.05 0.056 0.045 0.005 0.0051 0.0054 The parameters of normal blood flow in man and elements of WM (shows Tab. 1.) used for the calculation were taken from Westerhof [5]. The values are - I0=500 ml, TS=0.3 s, T=0.8 s. Fig. 3: Arterial pressure for three WM (a – measured pressure (solid line), b – 4WM (dashed line), c – 3WM (dot line), d – 2WM (dot-and-dash line)) Figure 3 shows calculated blood pressure waveforms for different WMs. The two- and the three- and the four-element windkessels were fitted in the time domain with use of aortic flow as input and adjustment of the model parameters to minimize the root-mean-square deviation between measured pressure and windkessel-predicted pressure. The residual sum of squares (RSS) between windkessel-predicted (Pp) and measured (Pm) pressure was calculated as follows: ( )∑ −= N mp PPRSS 1 2, where N is the number of samples in the heart cycle studied. The root-mean-square error (RMSE) of the pressure deviations was calculated as follows: ()1−= NRSSRMSE . The curve b) gives best approximations for real system this curve representative pressure of 4-element WM . Tab. 2: The values of RSS and RMSE RSS [-] RMSE [-] 2 WM 3.7956e+005 20.8037 3 WM 2.6436e+005 17.3619 4 WM 9.4692e+004 10.3910 When we need information only about values of systolic and diastolic pressure, we can use the 2-element WM. On the other hand, if we need to know time dependency of blood pressure, we have to use the 4-element WM. The arterial resistive properties are given mainly by the small arteries and arterioles, and C is determined mainly by the elastic properties of the large arteries, in particular of the aorta. The Windkessel models thus gave insight into a contribution of different arterial properties to the heart load. 4 CONCLUSION The described models demonstrated how we can obtain pressure curves for the 2-, 3-, and 4-element Windkessel models. It is a simple matter to obtain pressure curves for any other differential model. Characteristics of the arterial system can usually be obtained from the differentials equation and the input impedance of the arterial tree. The input impedance is useful because it only requires the simultaneous measurements of the pressure and flow waveforms at the ascending aorta to provide information regarding the interaction between the proximal aorta and the peripheral vascular beds. Although distributed models can more accurately predict the propagating pressure and flow waveforms and the input impedance, they are generally more complex and time consuming for individual parameter identification which often outweigh any additional information that can be obtained. We have shown that the four-element windkessel model is able to fit ascending aortic pressure from flow well and that the fit is better than other models. We made this decision on the basis of the RSS and RMSE (see tab. 2). ACKNOWLEDGEMENTS The research was partially supported by the research program of the Brno University of Technology No. 262200011 “Research of Electronic Communication Systems” and by the research program of the CTU in Prague No. MSM210000012 “Transdisciplinary Research in Biomedical Engineering”. REFERENCES [1] Otto, F.: Die Grundform des arteriellen Pulses, Zeitung für Biologie 37 (1899) 483-586. [2] Yoshigi, M., et. al.: Characterization of embryonic aortic impedance with lumped parameter models'', Am. J. Physiol. 273 (1997) H19-H27. [3] Molino, P., et. al.: Beat-to-beat estimation of windkessel model parameters in conscious rats'', Am. J. Physiol. 274 (1998) H171-H177. [4] Broemser, Ph., et. al.: Ueber die Messung des Schlagvolumens des Herzens auf unblutigem Weg, Zeitung für Biologie 90 (1930) 467-507. [5] Westerhof, N., et. al.: An artificial arterial system for pumping hearts, Journal of Applied Physiology 31 (1971) 776-781. [6] Karamanoglu, M.: A System for Analysis of Arterial Blood Pressure Waveforms in Humans, Computers and Biomedical Research 30 (1997) 244-255. [7] Lambermont, B., et. al.: Comparison between Three- and Four-Element Windkessel Models to Characterize Vascular Properties of Pulmonary Circulation, Arch. Physiol. and Biochem. 105 (1997) 625-632.","libVersion":"0.2.3","langs":""}